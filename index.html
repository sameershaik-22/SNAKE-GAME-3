<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Snake Game</title>
<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
        color: #fff;
        overflow: hidden;
    }

    h1 {
        text-align: center;
        font-size: 40px;
        animation: glow 2s infinite alternate;
    }

    @keyframes glow {
        from { text-shadow: 0 0 10px #06b6d4; }
        to { text-shadow: 0 0 25px #00f5ff; }
    }

    #gameContainer {
        position: relative;
    }

    canvas {
        background: #111;
        display: block;
        margin: 20px auto;
        border: 5px solid #06b6d4;
        border-radius: 12px;
        box-shadow: 0 0 20px rgba(6,182,212,0.8);
        animation: zoomIn 0.8s ease;
    }

    @keyframes zoomIn {
        from { transform: scale(0.7); opacity: 0; }
        to { transform: scale(1); opacity: 1; }
    }

    .popup {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        background: rgba(0,0,0,0.95);
        padding: 40px 60px;
        border-radius: 20px;
        text-align: center;
        font-size: 26px;
        font-weight: bold;
        color: #fff;
        animation: popupAnim 0.5s forwards, bounce 1s infinite alternate;
        z-index: 10;
        user-select: none;
        box-shadow: 0 0 30px rgba(255,255,255,0.3);
    }

    @keyframes popupAnim {
        to { transform: translate(-50%, -50%) scale(1); }
    }

    @keyframes bounce {
        from { transform: translate(-50%, -50%) scale(1); }
        to { transform: translate(-50%, -55%) scale(1.05); }
    }

    .settings {
        margin-bottom: 15px;
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
        justify-content: center;
    }

    .settings select, .settings button {
        padding: 10px 18px;
        font-size: 16px;
        border-radius: 8px;
        border: none;
        outline: none;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .settings button:hover, .settings select:hover {
        transform: scale(1.1);
        box-shadow: 0 0 12px #06b6d4;
    }

    .scoreboard {
        text-align: center;
        font-size: 20px;
        margin-bottom: 5px;
    }

    /* Modal overlay */
    #permissionModal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0,0,0,0.9);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        color: #fff;
        font-size: 28px;
        z-index: 100;
        visibility: hidden;
        opacity: 0;
        transition: opacity 0.4s ease;
    }

    #permissionModal.show {
        visibility: visible;
        opacity: 1;
    }

    #permissionModal button {
        margin-top: 25px;
        padding: 14px 35px;
        font-size: 22px;
        border: none;
        border-radius: 8px;
        background: linear-gradient(45deg, #06b6d4, #00f5ff);
        color: #fff;
        cursor: pointer;
        transition: transform 0.2s ease;
    }

    #permissionModal button:hover {
        transform: scale(1.1);
        box-shadow: 0 0 18px #00f5ff;
    }

    /* Music + Sound Buttons */
    #musicBtn, #soundBtn {
        margin-left: 10px;
        padding: 8px 16px;
        border: none;
        border-radius: 8px;
        color: #fff;
        font-weight: bold;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    #musicBtn {
        background: linear-gradient(45deg, #ff6a00, #ffcc00);
    }
    #soundBtn {
        background: linear-gradient(45deg, #00ff88, #00ccff);
    }

    #musicBtn:hover { transform: scale(1.1); box-shadow: 0 0 12px #ffcc00; }
    #soundBtn:hover { transform: scale(1.1); box-shadow: 0 0 12px #00ffcc; }
</style>
</head>
<body>
<h1>üêç Snake Game üêç</h1>

<div class="settings">
  <select id="speedSelect">
        <option value="5">Low Speed</option>
        <option value="10" selected>Medium Speed</option>
        <option value="15">High Speed</option>
    </select>

    <select id="colorSelect">
        <option value="red" selected>Red</option>
        <option value="blue">Blue</option>
        <option value="green">Green</option>
        <option value="yellow">Yellow</option>
        <option value="orange">Orange</option>
    </select>

    <button id="startBtn">Start Game</button>
    <button id="pauseBtn" disabled>Pause</button>
    <button id="musicBtn">üîä Music On</button>
    <button id="soundBtn">üîî Sounds On</button>
</div>

<div class="scoreboard">
    Score: <span id="score">0</span> | High Score: <span id="highScore">0</span>
</div>

<div id="gameContainer">
    <canvas id="gameCanvas" width="500" height="500"></canvas>
</div>

<!-- Permission Modal -->
<div id="permissionModal">
    <div>üöÄ Do you want to start the game?</div>
    <button id="confirmStartBtn">Start</button>
</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const startBtn = document.getElementById('startBtn');
const pauseBtn = document.getElementById('pauseBtn');
const musicBtn = document.getElementById('musicBtn');
const soundBtn = document.getElementById('soundBtn');
const speedSelect = document.getElementById('speedSelect');
const colorSelect = document.getElementById('colorSelect');
const scoreEl = document.getElementById('score');
const highScoreEl = document.getElementById('highScore');
const permissionModal = document.getElementById('permissionModal');
const confirmStartBtn = document.getElementById('confirmStartBtn');

let snake = [];
let direction = 'RIGHT';
let food = {};
let speed = 12;
let snakeColor = 'red';
let score = 0;
let highScore = 0;
let gameInterval;
const gridSize = 20;
let canChangeDirection = true;
let isPaused = false;
let gameInitialized = false;

// üéµ Background music
const bgMusic = new Audio('https://www.bensound.com/bensound-music/bensound-epic.mp3');
bgMusic.loop = true;
bgMusic.volume = 0.5;
let musicOn = true;

// üéµ Sound effects
const eatSound = new Audio('https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg');
const gameOverSound = new Audio('https://actions.google.com/sounds/v1/alarms/bell_ring.ogg');
let soundsOn = true;

// Apple image
const appleImg = new Image();
appleImg.src = 'https://img.icons8.com/emoji/48/000000/red-apple.png';

// Controls
document.addEventListener('keydown', (e) => {
    if (!canChangeDirection) return;
    if (e.key === 'ArrowUp' && direction !== 'DOWN') direction = 'UP';
    else if (e.key === 'ArrowDown' && direction !== 'UP') direction = 'DOWN';
    else if (e.key === 'ArrowLeft' && direction !== 'RIGHT') direction = 'LEFT';
    else if (e.key === 'ArrowRight' && direction !== 'LEFT') direction = 'RIGHT';
    canChangeDirection = false;
    if (e.key.toLowerCase() === 'p') togglePause();
});

// Start button
startBtn.addEventListener('click', () => {
    if (!gameInitialized) {
        speed = parseInt(speedSelect.value);
        snakeColor = colorSelect.value;
        showPermissionModal();
    } else if (isPaused) {
        togglePause();
    } else {
        startGameLoop();
    }
});

// Pause button
pauseBtn.addEventListener('click', () => { togglePause(); });

// Music toggle
musicBtn.addEventListener('click', () => {
    if (musicOn) {
        bgMusic.pause();
        musicBtn.textContent = "üîá Music Off";
    } else {
        bgMusic.play();
        musicBtn.textContent = "üîä Music On";
    }
    musicOn = !musicOn;
});

// Sound toggle
soundBtn.addEventListener('click', () => {
    soundsOn = !soundsOn;
    soundBtn.textContent = soundsOn ? "üîî Sounds On" : "üîï Sounds Off";
});

// Confirm start
confirmStartBtn.addEventListener('click', () => {
    hidePermissionModal();
    initializeGame();
    if (musicOn) bgMusic.play();
});

// Show/Hide Modal
function showPermissionModal() { permissionModal.classList.add('show'); }
function hidePermissionModal() { permissionModal.classList.remove('show'); }

// Initialize
function initializeGame() {
    clearInterval(gameInterval);
    snake = [{x: 200, y: 200}];
    direction = 'RIGHT';
    spawnFood();
    score = 0;
    scoreEl.textContent = score;
    isPaused = true;
    pauseBtn.textContent = 'Pause';
    pauseBtn.disabled = false;
    gameInitialized = true;
    showPopup('‚ú® Game Ready! Click Start to Play ‚ú®', 1500);
}

// Start Loop
function startGameLoop() {
    if (!gameInitialized || !isPaused) return;
    isPaused = false;
    pauseBtn.textContent = 'Pause';
    gameInterval = setInterval(gameLoop, 1000 / speed);
    showPopup('üöÄ Game Started!', 1000);
}

// Game Loop
function gameLoop() {
    if (isPaused) return;
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    moveSnake();
    checkCollision();
    drawSnake();
    drawFood();
    canChangeDirection = true;
}

// Snake Movement
function moveSnake() {
    let head = {...snake[0]};
    if(direction === 'UP') head.y -= gridSize;
    if(direction === 'DOWN') head.y += gridSize;
    if(direction === 'LEFT') head.x -= gridSize;
    if(direction === 'RIGHT') head.x += gridSize;
    snake.unshift(head);

    if(head.x === food.x && head.y === food.y) {
        score += 10;
        scoreEl.textContent = score;
        if (soundsOn) eatSound.play();
        spawnFood();
    } else {
        snake.pop();
    }
}

// Draw Snake
function drawSnake() {
    snake.forEach((segment) => {
        const gradient = ctx.createRadialGradient(
            segment.x + gridSize/2, segment.y + gridSize/2, 3,
            segment.x + gridSize/2, segment.y + gridSize/2, gridSize/2
        );
        gradient.addColorStop(0, "white");
        gradient.addColorStop(1, snakeColor);

        ctx.fillStyle = gradient;
        ctx.beginPath();
        ctx.arc(segment.x + gridSize/2, segment.y + gridSize/2, gridSize/2 - 2, 0, Math.PI*2);
        ctx.fill();
    });

    // Snake head (eyes + nose)
    const head = snake[0];
    ctx.fillStyle = "white";
    ctx.beginPath();
    ctx.arc(head.x + gridSize/3, head.y + gridSize/3, 3, 0, Math.PI*2);
    ctx.arc(head.x + 2*gridSize/3, head.y + gridSize/3, 3, 0, Math.PI*2);
    ctx.fill();

    ctx.fillStyle = "black";
    ctx.beginPath();
    ctx.arc(head.x + gridSize/2, head.y + 2*gridSize/3, 2, 0, Math.PI*2);
    ctx.fill();
}

// Spawn Food
function spawnFood() {
    let valid = false;
    while (!valid) {
        food = {
            x: Math.floor(Math.random() * (canvas.width / gridSize)) * gridSize,
            y: Math.floor(Math.random() * (canvas.height / gridSize)) * gridSize
        };
        valid = !snake.some(seg => seg.x === food.x && seg.y === food.y);
    }
}

// Draw Food
function drawFood() {
    ctx.drawImage(appleImg, food.x, food.y, gridSize, gridSize);
}

// Check Collision
function checkCollision() {
    const head = snake[0];
    if(head.x < 0 || head.x >= canvas.width || head.y < 0 || head.y >= canvas.height) gameOver();
    for(let i = 1; i < snake.length; i++) {
        if(head.x === snake[i].x && head.y === snake[i].y) gameOver();
    }
}

// Game Over
function gameOver() {
    clearInterval(gameInterval);
    isPaused = true;
    pauseBtn.disabled = true;
    gameInitialized = false;
    if (soundsOn) gameOverSound.play();
    if(score > highScore) highScore = score;
    highScoreEl.textContent = highScore;
    showPopup('üíÄ Better Luck Next Time! üíÄ', 1500, () => { initializeGame(); });
}

// Popup
function showPopup(text, duration, callback) {
    const popup = document.createElement('div');
    popup.classList.add('popup');
    popup.textContent = text;
    document.getElementById('gameContainer').appendChild(popup);
    setTimeout(() => {
        popup.remove();
        if(callback) callback();
    }, duration);
}

// Pause/Resume
function togglePause() {
    if (!gameInitialized) return;
    if (isPaused) {
        startGameLoop();
        pauseBtn.textContent = 'Pause';
    } else {
        clearInterval(gameInterval);
        showPopup('‚è∏ Paused', 800);
        pauseBtn.textContent = 'Resume';
        isPaused = true;
    }
}
</script>
</body>
</html>
